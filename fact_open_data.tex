\PassOptionsToPackage{colorlinks, unicode, linkcolor=tugreen}{hyperref}
\documentclass[compress, 9pt, aspectratio=1610, professionalfonts]{beamer}

\usepackage{fontspec}
\usepackage{polyglossia}
\setmainlanguage{english}

\usepackage{microtype}

\usepackage{mathtools}
\usepackage[
  math-style=ISO,
  bold-style=ISO,
  nabla=upright,
  partial=upright,
]{unicode-math}
\setmathfont{Tex Gyre Pagella Math}[Scale=MatchLowercase]

\usepackage{csquotes}
\usepackage[
  locale=UK,
  load-configurations=astronomy,
  per-mode=symbol-or-fraction,
]{siunitx}
\DeclareSIUnit{\year}{a}
\AtBeginDocument{%
  \sisetup{%
    math-rm=\mathrm,
  }
}

\usepackage{graphicx}
\usepackage{xcolor}
\colorlet{darkred}{red!80!black}

\usepackage{tikz}
\usetikzlibrary{positioning}
\usetikzlibrary{calc}
\usetikzlibrary{arrows}
\usetikzlibrary{arrows.meta}
\usepackage{pgfplots}

\usepackage[backend=biber, style=verbose]{biblatex}
\addbibresource{references.bib}
\usepackage{hyperref}

\usetheme{tudo}

\input{commands.tex}

\author[M.\ Nöthe]{\textit{Maximilian Nöthe}, Kai Brügge for the FACT-Collaboration}
\date[20.3.2018]{DPG Frühjahrstagung 2018, Würzburg}
\title{FACT – Public Gamma-Ray Crab-Nebula Observations and Simulations}
\titlegraphic{\includegraphics[width=\linewidth]{images/crab_title.jpg}}

\institute[%
  {\includegraphics[height=\headerheight]{logos/fact.pdf}}%
  \hspace{1em}%
  {\includegraphics[height=\headerheight]{logos/sfb876.pdf}}%
  \hspace{1em}%
  {\includegraphics[height=\headerheight]{logos/e5logo.pdf}}%
]{
  {\includegraphics[height=0.75cm]{tu.pdf}}%
  \hspace{1em}%
  {\includegraphics[height=0.75cm]{logos/ethz.pdf}}%
  \hspace{1em}%
  {\includegraphics[height=0.75cm]{logos/isdc.pdf}}%
  \hspace{1em}%
  {\includegraphics[height=0.75cm]{logos/uniwue.pdf}}%
}

\begin{document}
\begin{frame}
  \maketitle
\end{frame}

\begin{frame}{Overview}
  \begin{columns}[c, onlytextwidth]
    \begin{column}{0.66\textwidth}
      \linespread{1.5}
      \tableofcontents[hideallsubsections]
    \end{column}
    \hfill
    \begin{column}{0.33\textwidth}
      \raggedleft
      \includegraphics[height=0.85\textheight]{fact_claro_crop.jpg}\\
      {\tiny[Miguel Claro]}
    \end{column}
  \end{columns}
\end{frame}

\section{Introduction}
\begin{frame}
  \begin{center}
    \begin{tikzpicture}
      \input{content/fact.tex}
    \end{tikzpicture}
  \end{center}
\end{frame}

\section{Dataset Overview}
\begin{frame}[c]{The Dataset}
  \begin{columns}[onlytextwidth]
    \begin{column}{0.55\textwidth}      
      \begin{itemize}
        \item Crab Observations from November 2013
        \item Point-source gamma-ray simulations
        \item Diffuse gamma-ray simulations
        \item Diffuse proton simulations
        \item Available in different formats and multiple analysis stages
      \end{itemize}
    \end{column}
    \hfill
    \begin{column}{0.4\textwidth}      
      \hfill
      \includegraphics[width=0.75\textheight]{images/crab_chandra.jpg}
    \end{column}
  \end{columns}
  \vspace{0.5cm}
  \begin{center}
    \LARGE\url{https://fact-project.org/data}
  \end{center}
\end{frame}

\begin{frame}[c]{Observations}
  \begin{columns}[onlytextwidth]
    \begin{column}{0.475\textwidth}      
      \begin{itemize}
        \item \num{17.7} hours of Crab Nebula observations
        \item Good environmental conditions
        \item Zenith distance between \ang{6} and \ang{30}
      \end{itemize}
      \vspace{0.25cm}
      \begin{center}
        \includegraphics[width=0.75\linewidth]{images/gtc.jpg}
      \end{center}
    \end{column}
    \hfill
    \begin{column}{0.475\textwidth}      
      \includegraphics{build/plots/zenith.pdf}
    \end{column}
  \end{columns}
  
\end{frame}

\begin{frame}[t]{Simulations}
  \begin{itemize}
    \item CORSIKA for air shower simulations
    \item CERES for FACT detector response simulations
  \end{itemize}

  \vspace{1cm}

  \begin{columns}[onlytextwidth]
    \begin{column}{0.475\textwidth}
      \textcolor{tugreen}{\Large Gammas}
      \begin{description}[Triggered Events]
        \item[Energy Range] \SI{200}{\GeV} – \SI{50}{\TeV}
        \item[Spectral Slope] \num{-2.7}
        \item[Max. Impact] \SI{270}{\meter}
        \item[Zenith Distance] \ang{0} – \ang{30}
        \item[CORSIKA Events] \num{12000000}
        \item[Triggered Events] \num{1914812}
      \end{description}
    \end{column}
    \hfill
    \begin{column}{0.475\textwidth}
      \textcolor{tugreen}{\Large Protons}
      \begin{description}[Triggered Events]
        \item[Energy Range] \SI{100}{\GeV} – \SI{200}{\TeV}
        \item[Spectral Slope] \num{-2.7}
        \item[Max. Impact] \SI{400}{\meter}
        \item[Zenith Distance] \ang{0} – \ang{30}
        \item[CORSIKA Events] \num{780046520}
        \item[Triggered Events] \num{509652}
      \end{description}
    \end{column}
  \end{columns}
\end{frame}

\begin{frame}[t]{A FACT Analysis}
  \begin{columns}[onlytextwidth]
    \begin{column}{0.475\textwidth}
      Classical IACT Analysis Chain
      \begin{enumerate}
        \item Raw Data Calibration
        \item Removal of electronic artifacts
        \item Extraction of number of photons and mean arrival times for each pixel
        \item Image parameterization
        \item Reconstruction of particle properties
          \begin{itemize}
            \item Energy
            \item Origin
            \item Particle type (\Photon, \Proton, \Muon)
          \end{itemize}
      \end{enumerate}
    \end{column}
    \hfill
    \begin{column}{0.475\textwidth}%
      \only<1>{\includegraphics{build/plots/drs_calib.pdf}}%
      \only<2>{\includegraphics{build/plots/spikes.pdf}}%
      \only<3>{\includegraphics{images/hillas_1.pdf}}%
      \only<4>{\includegraphics{images/hillas_2.pdf}}%
    \end{column}%
  \end{columns}
\end{frame}

\section{Data Formats}
\begin{frame}[t]{Raw Data}
  \begin{itemize}
    \item FACT observations are stored in custom compressed FITS Files called \texttt{zfits}\\
    \item Readers are available for
      \begin{description}
        \item[Python] \url{https://github.com/fact-project/zfits} 
        \item[Java] \url{https://github.com/fact-project/fact-tools} 
        \item[C++ (ROOT)] \url{https://trac.fact-project.org/browser/trunk/Mars} 
      \end{description}
    \item FACT-Tools can be easily used to convert \texttt{zfits} to standard FITS
    \item Simulations are stored in standard, gzipped FITS Files
    \item Raw Data consists of a single array of length $1440 \times 300$ ($N_\text{Pixels} \times N_\text{Slices}$)

      \vspace{0.2cm}
      \begin{center}
        \begin{tikzpicture}
          \foreach \i in {0,...,2} {
            \node[anchor=west, minimum width=0.5cm, minimum height=0.5cm, fill=blue!20, draw=black] at (\i * 0.5cm, 0) {\tiny \i};
          }
          \node[anchor=west, minimum width=0.5cm, minimum height=0.5cm] at (1.5cm, 0) {$\cdots$};
          \foreach \j in {298,299} {
            \node[anchor=west, minimum width=0.5cm, minimum height=0.5cm, fill=blue!20, draw=black] at (\j * 0.5cm - 147cm, 0) {\tiny \j};
          }
          \foreach \i in {0,...,2} {
            \node[anchor=west, minimum width=0.5cm, minimum height=0.5cm, fill=green!20, draw=black] at (\i * 0.5cm + 3cm, 0) {\tiny \i};
          }
          \node[anchor=west, minimum width=0.5cm, minimum height=0.5cm] at (4.5cm, 0) {$\cdots$};
          \foreach \j in {298,299} {
            \node[anchor=west, minimum width=0.5cm, minimum height=0.5cm, fill=green!20, draw=black] at (\j * 0.5cm - 144cm, 0) {\tiny \j};
          }
          \node[anchor=west, minimum width=0.5cm, minimum height=0.5cm] at (6cm, 0) {$\cdots$};
          \node at (1.5cm, -0.5cm) {Pixel 0};
          \node at (4.5cm, -0.5cm) {Pixel 1};
        \end{tikzpicture}
      \end{center}

      \vspace{0.2cm}
      \begin{center}
        \LARGE 0.9\,TB observations, 1.1\,TB simulations
      \end{center}
  \end{itemize}
    
  \begin{center}
    \small See: \cite{zfits}
  \end{center}
\end{frame}

\begin{frame}[c]{Photon Stream}
  \begin{columns}[onlytextwidth]
    \begin{column}{0.475\textwidth}
      \begin{itemize}
        \item The FACT Camera has single photon resolution
        \item Each photon produces a known pulse shape 
        \item Multiple photons just superimpose
        \item[→] Reconstruct the arrival time of each individual photon by subtracting pulses until a flat line is reached
        \item \emph{Much} smaller file size compared to raw data
        \item All FACT Data $\approx{}$ 8\,TB
      \end{itemize}
      \begin{center}
        \small See: \cite{photonstream}
      \end{center}
    \end{column}
    \begin{column}{0.475\textwidth}
      \includegraphics{build/plots/phs.pdf}
    \end{column}
  \end{columns}
\end{frame}

\section{FACT-Tools Standard Analysis}
\begin{frame}[t]{FACT-Tools}
  \begin{itemize}
    \item Extension of the \texttt{streams}-Framework to analyze FACT data
    \item Developed at TU Dortmund and ETHZ
    \item Also performs photonstream extraction
  \end{itemize}

  \vspace{0.25cm}
  \begin{center}
    \Large\url{https://github.com/fact-project/fact-tools}
  \end{center}

  \vspace{0.25cm}
  \begin{center}
    \begin{tikzpicture}[scale=1, transform shape]
      \input{content/data-flow.tex}
    \end{tikzpicture}
  \end{center}
\end{frame}

\begin{frame}[c, fragile]{Higher-Level Analysis}
  \begin{itemize}
    \item We use the Scientific Python Stack
    \item \texttt{scikit-learn} models for particle classification, energy estimation and reconstruction of origin
  \end{itemize}

  \vspace{0.25cm}
  
  Example analysis on the open data sample:

  \begin{verbatim}
  $ git clone https://github.com/fact-project/open_crab_sample_analysis
  $ pip install -r requirements.txt
  $ make
  \end{verbatim}

  This will download the data, train models, apply them and produce a $θ²$ plot for the source detection.

\end{frame}

\begin{frame}[t]{Result}
  \begin{center}
    \includegraphics{build/plots/theta2.pdf}
  \end{center}
\end{frame}

\section{Outlook \& Conclusion}

\begin{frame}[t]{Deep Learning}
  \begin{columns}[onlytextwidth]
    \begin{column}{0.55\textwidth}
      \begin{itemize}
        \item Ongoing efforts to try deep learning on this dataset
        \item Using photonstream representation
        \item Reducing the hexgrid and time domain to square images
      \end{itemize}

      See: \url{https://github.com/mackaiver/cnn_cherenkov}
    \end{column}
    \begin{column}{0.4\textwidth}
      \includegraphics[width=\textwidth]{images/shower_skewed.png}
    \end{column}
  \end{columns}
\end{frame}

\begin{frame}[c]{Conclusions}
  \begin{itemize}
    \item From the start, FACT made results of he Quick Look Analysis publicly available \url{https://fact-project.org/monitoring}
    \item In November, FACT released a dataset of Crab observations, from the raw data up.
    \item Accompanied by extensive simulations.
    \item FACT-Tools standard analysis has \SI{23.8}{σ} on this dataset
    \item Use it for education and outreach!
    \item Many possibilities including Deep Learning, Spectrum Estimation, etc.
    \item We are planning on releasing more data in the future.
  \end{itemize}
\end{frame}

\end{document}
